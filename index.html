<!DOCTYPE html>
<html>
<head>
    <title>Pong Game</title>
    <style>
        * { padding: 0; margin: 0; }
        canvas { background: #000; display: block; margin: 0 auto; width: 100%; height: 100vh; }
        #restart { display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 20px; padding: 10px 20px; }
    </style>
</head>
<body>
    <canvas id="pong"></canvas>
    <button id="restart">Restart Game</button>
    <script>
        const canvas = document.getElementById("pong");
        const context = canvas.getContext("2d");
        const restartButton = document.getElementById("restart");

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const ball = new Image();
        ball.src = "pelota.png";

        const ballPower1 = new Image();
        ballPower1.src = "pelotapower1.png";

        const ballPower2 = new Image();
        ballPower2.src = "pelotapower2.png";

        const player1 = new Image();
        player1.src = "jugador1.png";

        const player2 = new Image();
        player2.src = "jugador2.png";

        const ballObj = { x: canvas.width / 2, y: canvas.height / 2, dx: 4, dy: 4, radius: 10, speed: 2, image: ball };
        const playerWidth = 20, playerHeight = 100, playerSpeed = 2;
        let leftPlayerY = canvas.height / 2, rightPlayerY = canvas.height / 2;
        let upArrow = false, downArrow = false, wKey = false, sKey = false, dKey = false, rightArrow = false;
        let score1 = 0, score2 = 0;
        let boost1 = true, boost2 = true;
        let powerAnimation = 0;
        let trail = [];

        function animate() {
            context.clearRect(0, 0, canvas.width, canvas.height);
            context.drawImage(ballObj.image, ballObj.x, ballObj.y, ballObj.radius, ballObj.radius);
            context.drawImage(player1, 0, leftPlayerY, playerWidth, playerHeight);
            context.drawImage(player2, canvas.width - playerWidth, rightPlayerY, playerWidth, playerHeight);
            ballObj.x += ballObj.dx;
            ballObj.y += ballObj.dy;

            if(wKey && leftPlayerY > 0) leftPlayerY -= playerSpeed;
            else if(sKey && (leftPlayerY < canvas.height - playerHeight)) leftPlayerY += playerSpeed;

            if(upArrow && rightPlayerY > 0) rightPlayerY -= playerSpeed;
            else if(downArrow && (rightPlayerY < canvas.height - playerHeight)) rightPlayerY += playerSpeed;

            if(ballObj.y + ballObj.radius > canvas.height || ballObj.y - ballObj.radius < 0) ballObj.dy *= -1;
            if(ballObj.dx < 0 && ballObj.y + ballObj.radius > leftPlayerY && ballObj.y - ballObj.radius < leftPlayerY + playerHeight && ballObj.x - ballObj.radius < playerWidth) { ballObj.dx *= -1; if(dKey && boost1) { ballObj.dx *= 3; ballObj.image = (powerAnimation++ % 15 < 7) ? ballPower1 : ballPower2; boost1 = false; } }
            else if(ballObj.dx > 0 && ballObj.y + ballObj.radius > rightPlayerY && ballObj.y - ballObj.radius < rightPlayerY + playerHeight && ballObj.x + ballObj.radius > canvas.width - playerWidth) { ballObj.dx *= -1; if(rightArrow && boost2) { ballObj.dx *= 3; ballObj.image = (powerAnimation++ % 15 < 7) ? ballPower1 : ballPower2; boost2 = false; } }
            else if(ballObj.x + ballObj.radius > canvas.width) { ballObj.x = canvas.width / 2; ballObj.y = canvas.height / 2; score1++; ballObj.dx = 4; ballObj.image = ball; if(score1 % 3 == 0) boost1 = true; }
            else if(ballObj.x - ballObj.radius < 0) { ballObj.x = canvas.width / 2; ballObj.y = canvas.height / 2; score2++; ballObj.dx = -4; ballObj.image = ball; if(score2 % 3 == 0) boost2 = true; }

            context.fillStyle = "white";
            context.font = "24px Arial";
            context.fillText(`Player 1: ${score1}`, canvas.width / 2 - 100, 20);
            context.fillText(`Player 2: ${score2}`, canvas.width / 2 + 50, 20);

            if(boost1) context.drawImage(ballPower1, 10, 10, 20, 20);
            if(boost2) context.drawImage(ballPower2, canvas.width - 30, 10, 20, 20);

            if(score1 == 7) { context.fillText("Player 1 Wins!", canvas.width / 2 - 50, canvas.height / 2); restartButton.style.display = "block"; return; }
            if(score2 == 7) { context.fillText("Player 2 Wins!", canvas.width / 2 - 50, canvas.height / 2); restartButton.style.display = "block"; return; }

            requestAnimationFrame(animate);
        }

        window.addEventListener("keydown", function(event) {
            switch(event.keyCode) {
                case 38: upArrow = true; break;
                case 40: downArrow = true; break;
                case 87: wKey = true; break;
                case 83: sKey = true; break;
                case 68: dKey = true; break;
                case 39: rightArrow = true; break;
            }
        });

        window.addEventListener("keyup", function(event) {
            switch(event.keyCode) {
                case 38: upArrow = false; break;
                case 40: downArrow = false; break;
                case 87: wKey = false; break;
                case 83: sKey = false; break;
                case 68: dKey = false; break;
                case 39: rightArrow = false; break;
            }
        });

        canvas.addEventListener("touchstart", function(event) {
            let touch = event.touches[0];
            if(touch.clientX < canvas.width / 2) {
                if(touch.clientY < leftPlayerY + playerHeight / 2) wKey = true;
                else sKey = true;
            } else {
                if(touch.clientY < rightPlayerY + playerHeight / 2) upArrow = true;
                else downArrow = true;
            }
        });

        canvas.addEventListener("touchend", function(event) {
            wKey = false;
            sKey = false;
            upArrow = false;
            downArrow = false;
        });

        restartButton.addEventListener("click", function() {
            location.reload();
        });

        animate();
    </script>
</body>
</html>
